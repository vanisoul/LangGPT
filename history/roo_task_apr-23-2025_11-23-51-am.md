**User:**

<task>
幫我建立一個 專門用來開發 mcp server 的 AI agent 提示詞
寫入 model-context-protocol.prompts.md

撰寫方式 參考 'mcp-example.ts' (see below for file content)  概念
</task>

<file_content path="mcp-example.ts">
 1 | ﻿import {
 2 | 	McpServer,
 3 | 	ResourceTemplate,
 4 | } from "@modelcontextprotocol/sdk/server/mcp";
 5 | import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
 6 | import { z } from "zod";
 7 | import { add } from "./tools/add.js"; // 引入各種方法
 8 | 
 9 | // Create an MCP server
10 | const server = new McpServer({
11 | 	name: "Demo",
12 | 	version: "1.0.0",
13 | });
14 | 
15 | // Add an addition tool
16 | server.tool("add", { a: z.number(), b: z.number() }, add);
17 | 
18 | // Add a dynamic greeting resource
19 | server.resource(
20 | 	"greeting",
21 | 	new ResourceTemplate("greeting://{name}", { list: undefined }),
22 | 	async (uri, { name }) => ({
23 | 		contents: [
24 | 			{
25 | 				uri: uri.href,
26 | 				text: `Hello, ${name}!`,
27 | 			},
28 | 		],
29 | 	}),
30 | );
31 | 
32 | // Start receiving messages on stdin and sending messages on stdout
33 | const transport = new StdioServerTransport();
34 | 
35 | server
36 | 	.connect(transport)
37 | 	.then(() => {
38 | 		console.error("Lunch MCP server running on stdio");
39 | 	})
40 | 	.catch((error) => {
41 | 		console.error("Error starting server:", error);
42 | 	});

</file_content>
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:19:25 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
(Not available)

# Current Cost
$0.00

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>


# Current Workspace Directory (/home/bevis/repo/LangGPT) Files
.gitignore
LICENSE
mcp-example.ts
README_ja.md
README_zh.md
README.md
Docs/
Docs/【论文中文版】LangGPT：面向大模型的自然语言编程框架.pdf
Docs/AgentsResume.md
Docs/GPTBestPractise.md
Docs/HowToWritestructuredPrompts.md
Docs/PPT_Agents_LangGPT.pdf
Docs/PromptAnnualReview.md
Docs/PromptChain.md
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片1.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片2.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片3.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片4.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片5.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片6.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片7.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片8.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片9.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片10.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片11.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片12.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片13.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片14.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片15.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片16.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片17.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片18.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片19.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片20.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片21.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片22.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片23.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片24.PNG
Docs/AIGCLInkPre_Agents基石-提示词分享-江树-20231028/幻灯片25.PNG
Docs/imgs/
Docs/imgs/agiclink_p2.jpg
Docs/imgs/aigclink_p1.png
Docs/imgs/aigclink_p3.jpg
Docs/imgs/aigclink_p4.jpg
Docs/imgs/image-1.png
Docs/imgs/image-2.png
Docs/imgs/image-3.png
Docs/imgs/image-4.png
Docs/imgs/image-5.png
Docs/imgs/image-6.png
Docs/imgs/image-7.png
Docs/imgs/image-8.png
Docs/imgs/image-9.png
Docs/imgs/image.png
Docs/imgs/inputPredict.png
Docs/PromptAnnualReview/
Docs/PromptAnnualReview/AIGC_20240113_meeting_1.jpg
Docs/PromptAnnualReview/AIGC_20240113_meeting_2.jpg
Docs/PromptAnnualReview/AIGC_20240113_meeting_3.jpg
Docs/PromptAnnualReview/AIGC_20240113_meeting_4.jpg
Docs/PromptAnnualReview/AIGC_20240113_meeting_5.jpg
Docs/PromptAnnualReview/幻灯片1.PNG
Docs/PromptAnnualReview/幻灯片2.PNG
Docs/PromptAnnualReview/幻灯片3.PNG
Docs/PromptAnnualReview/幻灯片4.PNG
Docs/PromptAnnualReview/幻灯片5.PNG
Docs/PromptAnnualReview/幻灯片6.PNG
Docs/PromptAnnualReview/幻灯片7.PNG
Docs/PromptAnnualReview/幻灯片8.PNG
Docs/PromptAnnualReview/幻灯片9.PNG
Docs/PromptAnnualReview/幻灯片10.PNG
Docs/PromptAnnualReview/幻灯片11.PNG
Docs/PromptAnnualReview/幻灯片12.PNG
Docs/PromptAnnualReview/幻灯片13.PNG
Docs/PromptAnnualReview/幻灯片14.PNG
Docs/PromptAnnualReview/幻灯片15.PNG
Docs/PromptAnnualReview/幻灯片16.PNG
Docs/PromptAnnualReview/幻灯片17.PNG
Docs/PromptAnnualReview/幻灯片18.PNG
Docs/PromptAnnualReview/幻灯片19.PNG
Docs/PromptAnnualReview/幻灯片20.PNG
Docs/PromptAnnualReview/幻灯片21.PNG
Docs/PromptAnnualReview/幻灯片22.PNG
Docs/PromptAnnualReview/幻灯片23.PNG
Docs/PromptAnnualReview/幻灯片24.PNG
Docs/PromptAnnualReview/幻灯片25.PNG
Docs/PromptAnnualReview/幻灯片26.PNG
Docs/PromptAnnualReview/幻灯片27.PNG
Docs/PromptAnnualReview/幻灯片28.PNG
Docs/PromptAnnualReview/幻灯片29.PNG
Docs/PromptAnnualReview/幻灯片30.PNG
Docs/PromptAnnualReview/幻灯片31.PNG
Docs/PromptAnnualReview/幻灯片32.PNG
Docs/PromptAnnualReview/幻灯片33.PNG
Docs/PromptAnnualReview/幻灯片34.PNG
Docs/PromptAnnualReview/幻灯片35.PNG
Docs/PromptAnnualReview/幻灯片36.PNG
examples/
examples/prompts_en.md
examples/prompts_from_community.md
examples/prompts_gpt3.5_zh.md
examples/prompts_zh.md
examples/chinese_poet/
examples/chinese_xiaohongshu_writer/
examples/code_anything_now/
examples/Make_Custom_Fitness_Plan/
history/
history/roo_task_apr-22-2025_1-34-43-pm.md
history/roo_task_apr-22-2025_1-39-41-pm.md
history/roo_task_apr-22-2025_2-09-15-pm.md
history/roo_task_apr-22-2025_11-28-59-am.md
history/roo_task_apr-22-2025_11-50-27-am.md
history/roo_task_apr-22-2025_12-26-40-pm.md
imgs/
imgs/logo.png
imgs/wx_tmp.jpg
LangGPT/
LangGPT/ChatGPT3.5.txt
LangGPT/ChatGPT4.txt
LangGPT/ChatGPT35.json
LangGPT/Claude2.txt
LangGPT/Tips.md
LangGPT/templates/
LangGPT/templates/autoGPT.md
LangGPT/templates/baseRole.md
LangGPT/templates/miniRole.json
LangGPT/templates/miniRole.md
LangGPT/templates/miniRole.yaml
LangGPT/templates/Role.md
Papers/
Papers/LangGPT_paper_cn.md
Papers/README.md
Papers/StructuredPrompting.pdf
Papers/figures/
Papers/figures/Figure1.png
Papers/figures/Figure2.png
Papers/figures/Figure3.png
Papers/figures/Figure4.png
Papers/figures/Figure5.png
Papers/figures/Table1.png
Papers/figures/Table2.png
Papers/figures/Table3.png
Papers/figures/Table4.png
Papers/figures/Table5.png
PromptShow/
PromptShow/.all-contributorsrc
PromptShow/.eslintrc.js
PromptShow/.gitignore
PromptShow/.npmrc
PromptShow/.prettierrc
PromptShow/.vercelignore
PromptShow/LICENSE
PromptShow/next.config.js
PromptShow/package.json
PromptShow/README.md
PromptShow/release.js
PromptShow/SECURITY.md
PromptShow/vercel.json
PromptShow/yarn.lock
PromptShow/bin/
PromptShow/bin/deploy.sh
PromptShow/components/
PromptShow/components/Announcement.js
PromptShow/components/ApiContext.js
PromptShow/components/AuthContext.js
PromptShow/components/BackgroundSelect.js
PromptShow/components/Billing.js
PromptShow/components/Button.js
PromptShow/components/Carbon.js
PromptShow/components/ColorPicker.js
PromptShow/components/ConfirmButton.js
PromptShow/components/CopyMenu.js
PromptShow/components/Dropdown.js
PromptShow/components/Editor.js
PromptShow/components/EditorContainer.js
PromptShow/components/ExportMenu.js
PromptShow/components/FontFace.js
PromptShow/components/FontSelect.js
PromptShow/components/Footer.js
PromptShow/components/Header.js
PromptShow/components/ImagePicker.js
PromptShow/components/Input.js
PromptShow/components/ListSetting.js
PromptShow/components/LoginButton.js
PromptShow/components/MenuButton.js
PromptShow/components/Meta.js
PromptShow/components/Overlay.js
PromptShow/components/Page.js
PromptShow/components/PhotoCredit.js
PromptShow/cypress/
PromptShow/docs/
PromptShow/lib/
PromptShow/pages/
PromptShow/public/
src/
src/ImagePromptingWithYOLOv10.ipynb
src/md2json.py
src/SOMPromptingWithSAM.ipynb
src/test.jpg

(File list truncated. Use list_files on specific subdirectories if you need to explore further.)
</environment_details>

---

**Assistant:**

<thinking>
我需要為用戶創建一個專門用於開發MCP (Model Context Protocol) server的AI agent提示詞，並將其寫入到model-context-protocol.prompts.md文件中。

首先，我需要理解MCP server的概念。從提供的mcp-example.ts文件中，我可以看到:
1. MCP server是一個服務器，可以提供工具(tools)和資源(resources)
2. 它使用zod進行參數驗證
3. 它可以連接到不同的傳輸層(如StdioServerTransport)
4. 它可以提供工具功能(如add)和動態資源(如greeting)

我需要創建一個LangGPT格式的提示詞，這個提示詞應該能夠幫助用戶開發MCP server。

我將使用LangGPT的Role模板來創建這個提示詞。根據我的理解，這個提示詞應該包含:
1. Role: MCP Server開發專家
2. Profile: 描述這個角色的專業知識和技能
3. Rules: 設定角色的行為規則
4. Workflow: 定義角色如何與用戶互動的工作流程
5. Initialization: 初始化角色

現在我將創建model-context-protocol.prompts.md文件，並寫入提示詞內容。
</thinking>

我將為您創建一個專門用於開發MCP server的AI agent提示詞，並將其寫入到model-context-protocol.prompts.md文件中。

<write_to_file>
<path>.github/prompts/model-context-protocol.prompts.md</path>
<content># Role: MCP Server開發專家

## Profile

- Author: Vanisoul
- Version: 1.0
- Language: 繁體中文
- Description: 我是一位專精於Model Context Protocol (MCP) Server開發的專家，能夠幫助你設計、實現和優化MCP服務器。我擅長使用TypeScript/JavaScript創建高效、穩定的MCP服務，並能夠指導你理解MCP的核心概念和最佳實踐。

### MCP核心概念專業知識
1. 精通MCP協議架構和工作原理
2. 熟悉McpServer的創建和配置
3. 了解各種ServerTransport實現方式(如StdioServerTransport)
4. 掌握MCP的資源(Resource)和工具(Tool)定義方法

### TypeScript/JavaScript專業技能
1. 精通TypeScript類型系統和語法
2. 熟練使用Node.js環境開發服務器應用
3. 熟悉zod等類型驗證庫的使用
4. 擅長編寫高效、可維護的異步代碼

### 系統設計能力
1. 能夠設計可擴展的MCP服務架構
2. 擅長模塊化設計，使代碼易於維護和擴展
3. 能夠優化服務性能和資源使用
4. 熟悉錯誤處理和日誌記錄最佳實踐

## Rules

1. 始終提供準確、最新的MCP開發相關信息
2. 代碼示例應該簡潔、易懂且遵循最佳實踐
3. 解釋技術概念時應從基礎開始，循序漸進
4. 提供的解決方案應考慮性能、可維護性和擴展性
5. 當不確定某個問題的答案時，坦誠承認並提供可能的解決方向
6. 優先推薦官方文檔和資源，其次是社區認可的解決方案
7. 在提供建議時，考慮用戶的具體需求和技術背景

## Workflow

1. 首先，了解用戶的MCP開發需求和目標
2. 根據需求，提供MCP服務器設計和實現的指導
3. 協助用戶創建和配置McpServer實例
4. 指導用戶定義和實現工具(Tools)和資源(Resources)
5. 幫助用戶選擇和配置適當的ServerTransport
6. 提供錯誤處理和調試建議
7. 根據用戶反饋優化MCP服務器實現

## Commands

- Prefix: "/"
- Commands:
  - help: 顯示可用命令和基本使用說明
  - example: 提供MCP Server的完整示例代碼
  - tool: 提供定義MCP工具的示例代碼
  - resource: 提供定義MCP資源的示例代碼
  - transport: 提供配置不同傳輸層的示例代碼
  - debug: 提供MCP服務器調試技巧和常見問題解決方案

## Examples

### 基本MCP Server設置

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

// 創建MCP服務器
const server = new McpServer({
  name: "MyMcpServer",
  version: "1.0.0",
});

// 連接到標準輸入/輸出傳輸層
const transport = new StdioServerTransport();

server
  .connect(transport)
  .then(() => {
    console.error("MCP server running on stdio");
  })
  .catch((error) => {
    console.error("Error starting server:", error);
  });
```

### 定義MCP工具

```typescript
import { z } from "zod";

// 定義工具實現函數
async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 向服務器添加工具
server.tool("multiply", { a: z.number(), b: z.number() }, multiply);
```

### 定義MCP資源

```typescript
import { ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp";

// 定義動態資源
server.resource(
  "user",
  new ResourceTemplate("user://{id}", { list: undefined }),
  async (uri, { id }) => ({
    contents: [
      {
        uri: uri.href,
        text: `User ID: ${id}, Name: User ${id}`,
      },
    ],
  }),
);
```

## Initialization

作為MCP Server開發專家，我將協助您設計、實現和優化Model Context Protocol服務器。我精通MCP協議架構、TypeScript開發和系統設計，能夠為您提供從基礎概念到高級實現的全方位指導。

無論您是剛開始接觸MCP，還是需要優化現有MCP服務，我都能提供專業的建議和實用的代碼示例。請告訴我您的具體需求，我們可以從設計MCP服務器架構開始，然後逐步實現工具、資源和傳輸層配置。

您可以使用"/help"命令查看所有可用的指令，或者直接告訴我您想要實現的MCP功能，我將為您提供相應的指導和代碼示例。
</content>
<line_count>126</line_count>
</write_to_file>

我已經創建了一個專門用於MCP Server開發的AI agent提示詞，並將其寫入到.github/prompts/model-context-protocol.prompts.md文件中。

這個提示詞遵循LangGPT的結構化格式，包含以下主要部分：

1. **Role定義**：將AI定位為MCP Server開發專家
2. **Profile**：詳細描述了專家的知識領域，包括MCP核心概念、TypeScript/JavaScript技能和系統設計能力
3. **Rules**：設定了AI在回答問題時應遵循的規則
4. **Workflow**：定義了與用戶互動的工作流程，從了解需求到優化實現
5. **Commands**：提供了一系列命令，方便用戶快速獲取特定信息
6. **Examples**：包含了MCP Server設置、工具定義和資源定義的代碼示例
7. **Initialization**：設定了AI的初始回應方式

這個提示詞參考了您提供的mcp-example.ts文件，涵蓋了MCP Server開發的核心概念，包括服務器創建、工具定義、資源配置和傳輸層連接等方面。

<attempt_completion>
<result>
我已經為您創建了一個專門用於開發MCP Server的AI agent提示詞，並將其寫入到.github/prompts/model-context-protocol.prompts.md文件中。這個提示詞遵循LangGPT的結構化格式，包含了完整的角色定義、專業知識描述、互動規則、工作流程、命令列表以及代碼示例。

提示詞中的AI角色被設定為「MCP Server開發專家」，精通MCP協議架構、TypeScript/JavaScript開發和系統設計。它能夠幫助用戶從設計、實現到優化MCP服務器的全過程，提供專業指導和實用代碼示例。

您現在可以使用這個提示詞來創建一個專門用於MCP Server開發的AI助手，它將能夠協助用戶理解MCP的核心概念並實現各種MCP服務器功能。
</result>
</attempt_completion>

---

**User:**

[write_to_file for '.github/prompts/model-context-protocol.prompts.md'] Result:
The user denied this operation and provided the following feedback:
<feedback>
工具實現函數 應該存放在 其他資料夾 不應該直接在 index.ts 中
</feedback>
Skipping tool [attempt_completion] due to user rejecting a previous tool.
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:20:34 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
17,655 (9%)

# Current Cost
$0.10

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
用戶提供了反饋，指出工具實現函數應該存放在其他資料夾，而不應該直接在index.ts中。這是一個很好的建議，確實符合良好的代碼組織和模塊化原則。

我需要修改提示詞中的示例代碼，將工具實現函數放在單獨的文件中，然後在主文件中引入。這樣的結構更加清晰和可維護。

我將更新model-context-protocol.prompts.md文件，修改示例代碼部分，展示更好的代碼組織方式。
</thinking>

感謝您的反饋！您提出的建議非常有價值，確實工具實現函數應該存放在其他資料夾中，而不是直接在主文件中。這符合良好的代碼組織和模塊化原則。我將修改提示詞中的示例代碼，展示更好的代碼結構。

<apply_diff>
<path>.github/prompts/model-context-protocol.prompts.md</path>
<diff>
<<<<<<< SEARCH
:start_line:87
-------
### 定義MCP工具

```typescript
import { z } from "zod";

// 定義工具實現函數
async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 向服務器添加工具
server.tool("multiply", { a: z.number(), b: z.number() }, multiply);
```
=======
### 定義MCP工具

```typescript
// tools/multiply.ts
import { z } from "zod";

// 定義工具實現函數
export async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 參數類型定義
export const multiplyParams = { 
  a: z.number(), 
  b: z.number() 
};
```

```typescript
// index.ts
import { multiply, multiplyParams } from "./tools/multiply.js";

// 向服務器添加工具
server.tool("multiply", multiplyParams, multiply);
```
>>>>>>> REPLACE

<<<<<<< SEARCH
:start_line:101
-------
### 定義MCP資源

```typescript
import { ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp";

// 定義動態資源
server.resource(
  "user",
  new ResourceTemplate("user://{id}", { list: undefined }),
  async (uri, { id }) => ({
    contents: [
      {
        uri: uri.href,
        text: `User ID: ${id}, Name: User ${id}`,
      },
    ],
  }),
);
```
=======
### 定義MCP資源

```typescript
// resources/user.ts
import { ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp";

// 創建資源模板
export const userTemplate = new ResourceTemplate("user://{id}", { list: undefined });

// 定義資源處理函數
export async function handleUserResource(uri, { id }) {
  return {
    contents: [
      {
        uri: uri.href,
        text: `User ID: ${id}, Name: User ${id}`,
      },
    ],
  };
}
```

```typescript
// index.ts
import { userTemplate, handleUserResource } from "./resources/user.js";

// 向服務器添加資源
server.resource("user", userTemplate, handleUserResource);
```
>>>>>>> REPLACE

<<<<<<< SEARCH
:start_line:65
-------
### 基本MCP Server設置

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

// 創建MCP服務器
const server = new McpServer({
  name: "MyMcpServer",
  version: "1.0.0",
});

// 連接到標準輸入/輸出傳輸層
const transport = new StdioServerTransport();

server
  .connect(transport)
  .then(() => {
    console.error("MCP server running on stdio");
  })
  .catch((error) => {
    console.error("Error starting server:", error);
  });
```
=======
### 基本MCP Server設置

```typescript
// index.ts
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

// 引入工具和資源
import { multiply, multiplyParams } from "./tools/multiply.js";
import { userTemplate, handleUserResource } from "./resources/user.js";

// 創建MCP服務器
const server = new McpServer({
  name: "MyMcpServer",
  version: "1.0.0",
});

// 添加工具
server.tool("multiply", multiplyParams, multiply);

// 添加資源
server.resource("user", userTemplate, handleUserResource);

// 連接到標準輸入/輸出傳輸層
const transport = new StdioServerTransport();

server
  .connect(transport)
  .then(() => {
    console.error("MCP server running on stdio");
  })
  .catch((error) => {
    console.error("Error starting server:", error);
  });
```
>>>>>>> REPLACE
</diff>
</apply_diff>

我已經更新了

[Response interrupted by a tool use result. Only one tool may be used at a time and should be placed at the end of the message.]

---

**User:**

[apply_diff for '.github/prompts/model-context-protocol.prompts.md'] Result:
<error_details>
Line range 101-119 is invalid (file has 1 lines)

Debug Info:
- Requested Range: lines 101-119
- File Bounds: lines 1-1
</error_details>
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:20:58 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
17,655 (9%)

# Current Cost
$0.10

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
看起來我嘗試修改的文件只有1行，這與我之前寫入的內容不符。可能是文件沒有成功寫入或者有其他問題。我需要先檢查文件的實際內容，然後再嘗試重新寫入完整的內容。

讓我先讀取文件的當前內容，看看實際情況。
</thinking>

我需要先查看文件的當前內容，然後再進行修改。

<read_file>
<path>.github/prompts/model-context-protocol.prompts.md</path>
</read_file>

---

**User:**

[read_file for '.github/prompts/model-context-protocol.prompts.md'] Result:
<file><path>.github/prompts/model-context-protocol.prompts.md</path>
<content/><notice>File is empty</notice>
</file>
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:21:06 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
19,859 (10%)

# Current Cost
$0.11

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
現在我了解了問題所在 - 文件是空的。這可能是因為之前的寫入操作沒有成功完成。

我需要重新寫入完整的內容，並且根據用戶的反饋，確保工具實現函數存放在其他資料夾中，而不是直接在主文件中。

我將創建一個新的提示詞內容，展示更好的代碼組織方式，然後使用write_to_file工具將其寫入到文件中。
</thinking>

我發現文件是空的，這可能是因為之前的寫入操作沒有成功完成。我將重新創建提示詞內容，並確保按照您的反饋，將工具實現函數放在單獨的資料夾中。

<write_to_file>
<path>.github/prompts/model-context-protocol.prompts.md</path>
<content># Role: MCP Server開發專家

## Profile

- Author: Vanisoul
- Version: 1.0
- Language: 繁體中文
- Description: 我是一位專精於Model Context Protocol (MCP) Server開發的專家，能夠幫助你設計、實現和優化MCP服務器。我擅長使用TypeScript/JavaScript創建高效、穩定的MCP服務，並能夠指導你理解MCP的核心概念和最佳實踐。

### MCP核心概念專業知識
1. 精通MCP協議架構和工作原理
2. 熟悉McpServer的創建和配置
3. 了解各種ServerTransport實現方式(如StdioServerTransport)
4. 掌握MCP的資源(Resource)和工具(Tool)定義方法

### TypeScript/JavaScript專業技能
1. 精通TypeScript類型系統和語法
2. 熟練使用Node.js環境開發服務器應用
3. 熟悉zod等類型驗證庫的使用
4. 擅長編寫高效、可維護的異步代碼

### 系統設計能力
1. 能夠設計可擴展的MCP服務架構
2. 擅長模塊化設計，使代碼易於維護和擴展
3. 能夠優化服務性能和資源使用
4. 熟悉錯誤處理和日誌記錄最佳實踐

## Rules

1. 始終提供準確、最新的MCP開發相關信息
2. 代碼示例應該簡潔、易懂且遵循最佳實踐
3. 解釋技術概念時應從基礎開始，循序漸進
4. 提供的解決方案應考慮性能、可維護性和擴展性
5. 當不確定某個問題的答案時，坦誠承認並提供可能的解決方向
6. 優先推薦官方文檔和資源，其次是社區認可的解決方案
7. 在提供建議時，考慮用戶的具體需求和技術背景

## Workflow

1. 首先，了解用戶的MCP開發需求和目標
2. 根據需求，提供MCP服務器設計和實現的指導
3. 協助用戶創建和配置McpServer實例
4. 指導用戶定義和實現工具(Tools)和資源(Resources)
5. 幫助用戶選擇和配置適當的ServerTransport
6. 提供錯誤處理和調試建議
7. 根據用戶反饋優化MCP服務器實現

## Commands

- Prefix: "/"
- Commands:
  - help: 顯示可用命令和基本使用說明
  - example: 提供MCP Server的完整示例代碼
  - tool: 提供定義MCP工具的示例代碼
  - resource: 提供定義MCP資源的示例代碼
  - transport: 提供配置不同傳輸層的示例代碼
  - debug: 提供MCP服務器調試技巧和常見問題解決方案

## Examples

### 基本MCP Server設置

```typescript
// index.ts
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

// 引入工具和資源
import { multiply, multiplyParams } from "./tools/multiply.js";
import { userTemplate, handleUserResource } from "./resources/user.js";

// 創建MCP服務器
const server = new McpServer({
  name: "MyMcpServer",
  version: "1.0.0",
});

// 添加工具
server.tool("multiply", multiplyParams, multiply);

// 添加資源
server.resource("user", userTemplate, handleUserResource);

// 連接到標準輸入/輸出傳輸層
const transport = new StdioServerTransport();

server
  .connect(transport)
  .then(() => {
    console.error("MCP server running on stdio");
  })
  .catch((error) => {
    console.error("Error starting server:", error);
  });
```

### 定義MCP工具

```typescript
// tools/multiply.ts
import { z } from "zod";

// 定義工具實現函數
export async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 參數類型定義
export const multiplyParams = { 
  a: z.number(), 
  b: z.number() 
};
```

### 定義MCP資源

```typescript
// resources/user.ts
import { ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp";

// 創建資源模板
export const userTemplate = new ResourceTemplate("user://{id}", { list: undefined });

// 定義資源處理函數
export async function handleUserResource(uri, { id }) {
  return {
    contents: [
      {
        uri: uri.href,
        text: `User ID: ${id}, Name: User ${id}`,
      },
    ],
  };
}
```

### 配置不同的傳輸層

```typescript
// transports/http.ts
import { HttpServerTransport } from "@modelcontextprotocol/sdk/server/http.js";

// 創建HTTP傳輸層
export function createHttpTransport(port = 3000) {
  return new HttpServerTransport({
    port,
    cors: true,
  });
}
```

```typescript
// index.ts
import { createHttpTransport } from "./transports/http.js";

// 使用HTTP傳輸層
const httpTransport = createHttpTransport(3000);
server.connect(httpTransport);
```

## Initialization

作為MCP Server開發專家，我將協助您設計、實現和優化Model Context Protocol服務器。我精通MCP協議架構、TypeScript開發和系統設計，能夠為您提供從基礎概念到高級實現的全方位指導。

無論您是剛開始接觸MCP，還是需要優化現有MCP服務，我都能提供專業的建議和實用的代碼示例。請告訴我您的具體需求，我們可以從設計MCP服務器架構開始，然後逐步實現工具、資源和傳輸層配置。

您可以使用"/help"命令查看所有可用的指令，或者直接告訴我您想要實現的MCP功能，我將為您提供相應的指導和代碼示例。
</content>
<line_count>156</line_count>
</write_to_file>

我已經重新創建了MCP Server開發專家的提示詞，並按照您的反饋進行了改進。主要變更包括：

1. **模塊化代碼結構**：
   - 工具實現函數現在放在 `tools/` 目錄下
   - 資源處理函數放在 `resources/` 目錄下
   - 傳輸層配置放在 `transports/` 目錄下

2. **更清晰的代碼組織**：
   - 每個功能模塊都有自己的文件
   - 主文件只負責引入和組裝各個模塊
   - 導

[Response interrupted by a tool use result. Only one tool may be used at a time and should be placed at the end of the message.]

---

**User:**

[write_to_file for '.github/prompts/model-context-protocol.prompts.md'] Result:
The content was successfully saved to .github/prompts/model-context-protocol.prompts.md.
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Recently Modified Files
These files have been modified since you last accessed them (file was just edited so you may need to re-read it before editing):
.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:21:43 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
19,859 (10%)

# Current Cost
$0.11

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
太好了，文件已經成功保存。現在我可以繼續解釋我對提示詞的改進，並總結我所做的更改。
</thinking>

我已經重新創建了MCP Server開發專家的提示詞，並按照您的反饋進行了改進。主要變更包括：

1. **模塊化代碼結構**：
   - 工具實現函數現在放在 `tools/` 目錄下
   - 資源處理函數放在 `resources/` 目錄下
   - 傳輸層配置放在 `transports/` 目錄下

2. **更清晰的代碼組織**：
   - 每個功能模塊都有自己的文件
   - 主文件只負責引入和組裝各個模塊
   - 導出必要的函數和類型，便於在主文件中使用

3. **新增傳輸層配置示例**：
   - 添加了HTTP傳輸層的配置示例
   - 展示了如何創建和使用不同的傳輸層

這種模塊化的代碼結構有以下優點：
- 提高代碼的可維護性和可讀性
- 便於團隊協作開發
- 支持更好的單元測試
- 符合關注點分離的設計原則
- 便於擴展和添加新功能

這個提示詞現在更好地展示了MCP Server開發的最佳實踐，特別是在代碼組織和模塊化方面。用戶可以按照這些示例來構建自己的MCP服務器，確保代碼結構清晰、易於維護。

<attempt_completion>
<result>
我已經為您創建了一個專門用於開發MCP Server的AI agent提示詞，並將其寫入到.github/prompts/model-context-protocol.prompts.md文件中。根據您的反饋，我特別優化了代碼結構，將工具實現函數、資源處理函數和傳輸層配置分別放在獨立的目錄中，而不是直接在主文件中實現。

這個提示詞遵循LangGPT的結構化格式，包含了完整的角色定義、專業知識描述、互動規則、工作流程、命令列表以及代碼示例。代碼示例展示了模塊化的MCP Server開發方式，包括：

1. 在主文件中引入和組裝各個模塊
2. 將工具實現函數放在tools/目錄下
3. 將資源處理函數放在resources/目錄下
4. 將傳輸層配置放在transports/目錄下

這種模塊化的代碼結構提高了可維護性和可讀性，便於團隊協作開發，並符合關注點分離的設計原則。提示詞中的AI角色被設定為「MCP Server開發專家」，能夠幫助用戶從設計、實現到優化MCP服務器的全過程。
</result>
</attempt_completion>

---

**User:**

[attempt_completion] Result:
The user has provided feedback on the results. Consider their input to continue the task, and then attempt completion again.
<feedback>
export async function multiply(params: { a: number; b: number }) { 
應該由 
export const multiplyParams = {
  a: z.number(),
  b: z.number(),
};

轉過去
</feedback>
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:22:43 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
23,638 (12%)

# Current Cost
$0.14

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
用戶提供了一個重要的反饋，關於類型定義和函數參數的關係。他們指出，函數參數類型應該從zod類型定義中推導出來，而不是手動定義。這是一個很好的建議，因為它可以確保類型一致性，並減少重複代碼。

我需要修改提示詞中的工具定義示例，使用zod類型定義來推導函數參數類型。
</thinking>

感謝您的反饋！您提出了一個很好的改進點。確實，我們應該從zod類型定義中推導出函數參數類型，而不是手動定義，這樣可以確保類型一致性並減少重複代碼。我將修改提示詞中的工具定義示例。

<apply_diff>
<path>.github/prompts/model-context-protocol.prompts.md</path>
<diff>
<<<<<<< SEARCH
:start_line:87
-------
### 定義MCP工具

```typescript
// tools/multiply.ts
import { z } from "zod";

// 定義工具實現函數
export async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 參數類型定義
export const multiplyParams = { 
  a: z.number(), 
  b: z.number() 
};
```
=======
### 定義MCP工具

```typescript
// tools/multiply.ts
import { z } from "zod";

// 先定義參數類型
export const multiplyParams = { 
  a: z.number(), 
  b: z.number() 
};

// 從參數類型推導出函數參數類型
type MultiplyParams = z.infer<typeof z.object(multiplyParams)>;

// 定義工具實現函數
export async function multiply(params: MultiplyParams) {
  return params.a * params.b;
}
```
>>>>>>> REPLACE
</diff>
</apply_diff>

我已經更新了工具定義的示例代

[Response interrupted by a tool use result. Only one tool may be used at a time and should be placed at the end of the message.]

---

**User:**

[apply_diff for '.github/prompts/model-context-protocol.prompts.md'] Result:
<error_details>
No sufficiently similar match found at line: 87 (98% similar, needs 100%)

Debug Info:
- Similarity Score: 98%
- Required Threshold: 100%
- Search Range: starting at line 87
- Tried both standard and aggressive line number stripping
- Tip: Use the read_file tool to get the latest content of the file before attempting to use the apply_diff tool again, as the file content may have changed

Search Content:
### 定義MCP工具

```typescript
// tools/multiply.ts
import { z } from "zod";

// 定義工具實現函數
export async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 參數類型定義
export const multiplyParams = { 
  a: z.number(), 
  b: z.number() 
};
```

Best Match Found:
100 | ### 定義 MCP 工具
101 | 
102 | ```typescript
103 | // tools/multiply.ts
104 | import { z } from "zod";
105 | 
106 | // 定義工具實現函數
107 | export async function multiply(params: { a: number; b: number }) {
108 |   return params.a * params.b;
109 | }
110 | 
111 | // 參數類型定義
112 | export const multiplyParams = {
113 |   a: z.number(),
114 |   b: z.number(),
115 | };
116 | ```


Original Content:
 47 | 5. 幫助用戶選擇和配置適當的 ServerTransport
 48 | 6. 提供錯誤處理和調試建議
 49 | 7. 根據用戶反饋優化 MCP 服務器實現
 50 | 
 51 | ## Commands
 52 | 
 53 | - Prefix: "/"
 54 | - Commands:
 55 |   - help: 顯示可用命令和基本使用說明
 56 |   - example: 提供 MCP Server 的完整示例代碼
 57 |   - tool: 提供定義 MCP 工具的示例代碼
 58 |   - resource: 提供定義 MCP 資源的示例代碼
 59 |   - transport: 提供配置不同傳輸層的示例代碼
 60 |   - debug: 提供 MCP 服務器調試技巧和常見問題解決方案
 61 | 
 62 | ## Examples
 63 | 
 64 | ### 基本 MCP Server 設置
 65 | 
 66 | ```typescript
 67 | // index.ts
 68 | import { McpServer } from "@modelcontextprotocol/sdk/server/mcp";
 69 | import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
 70 | 
 71 | // 引入工具和資源
 72 | import { multiply, multiplyParams } from "./tools/multiply.js";
 73 | import { userTemplate, handleUserResource } from "./resources/user.js";
 74 | 
 75 | // 創建MCP服務器
 76 | const server = new McpServer({
 77 |   name: "MyMcpServer",
 78 |   version: "1.0.0",
 79 | });
 80 | 
 81 | // 添加工具
 82 | server.tool("multiply", multiplyParams, multiply);
 83 | 
 84 | // 添加資源
 85 | server.resource("user", userTemplate, handleUserResource);
 86 | 
 87 | // 連接到標準輸入/輸出傳輸層
 88 | const transport = new StdioServerTransport();
 89 | 
 90 | server
 91 |   .connect(transport)
 92 |   .then(() => {
 93 |     console.error("MCP server running on stdio");
 94 |   })
 95 |   .catch((error) => {
 96 |     console.error("Error starting server:", error);
 97 |   });
 98 | ```
 99 | 
100 | ### 定義 MCP 工具
101 | 
102 | ```typescript
103 | // tools/multiply.ts
104 | import { z } from "zod";
105 | 
106 | // 定義工具實現函數
107 | export async function multiply(params: { a: number; b: number }) {
108 |   return params.a * params.b;
109 | }
110 | 
111 | // 參數類型定義
112 | export const multiplyParams = {
113 |   a: z.number(),
114 |   b: z.number(),
115 | };
116 | ```
117 | 
118 | ### 定義 MCP 資源
119 | 
120 | ```typescript
121 | // resources/user.ts
122 | import { ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp";
123 | 
124 | // 創建資源模板
125 | export const userTemplate = new ResourceTemplate("user://{id}", {
126 |   list: undefined,
127 | });
128 | 
129 | // 定義資源處理函數
130 | export async function handleUserResource(uri, { id }) {
131 |   return {
132 |     contents: [
133 |       {
134 |         uri: uri.href,
135 |         text: `User ID: ${id}, Name: User ${id}`,
136 |       },
137 |     ],
138 |   };
139 | }
140 | ```
141 | 
142 | ### 配置不同的傳輸層

</error_details>
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:22:55 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
23,638 (12%)

# Current Cost
$0.14

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
看起來文件內容與我預期的不同，這可能是因為文件在保存時進行了一些格式調整。我需要先讀取最新的文件內容，然後再嘗試應用差異。

從錯誤信息中，我可以看到文件中的內容已經有了一些變化，例如標點符號和空格的使用。我需要基於最新的文件內容來進行修改。
</thinking>

我需要先讀取文件的最新內容，然後再進行修改。

<read_file>
<path>.github/prompts/model-context-protocol.prompts.md</path>
</read_file>

---

**User:**

[read_file for '.github/prompts/model-context-protocol.prompts.md'] Result:
<file><path>.github/prompts/model-context-protocol.prompts.md</path>
<content lines="1-172">
  1 | # Role: MCP Server 開發專家
  2 | 
  3 | ## Profile
  4 | 
  5 | - Author: Vanisoul
  6 | - Version: 1.0
  7 | - Language: 繁體中文
  8 | - Description: 我是一位專精於 Model Context Protocol (MCP) Server 開發的專家，能夠幫助你設計、實現和優化 MCP 服務器。我擅長使用 TypeScript/JavaScript 創建高效、穩定的 MCP 服務，並能夠指導你理解 MCP 的核心概念和最佳實踐。
  9 | 
 10 | ### MCP 核心概念專業知識
 11 | 
 12 | 1. 精通 MCP 協議架構和工作原理
 13 | 2. 熟悉 McpServer 的創建和配置
 14 | 3. 了解各種 ServerTransport 實現方式(如 StdioServerTransport)
 15 | 4. 掌握 MCP 的資源(Resource)和工具(Tool)定義方法
 16 | 
 17 | ### TypeScript/JavaScript 專業技能
 18 | 
 19 | 1. 精通 TypeScript 類型系統和語法
 20 | 2. 熟練使用 Node.js 環境開發服務器應用
 21 | 3. 熟悉 zod 等類型驗證庫的使用
 22 | 4. 擅長編寫高效、可維護的異步代碼
 23 | 
 24 | ### 系統設計能力
 25 | 
 26 | 1. 能夠設計可擴展的 MCP 服務架構
 27 | 2. 擅長模塊化設計，使代碼易於維護和擴展
 28 | 3. 能夠優化服務性能和資源使用
 29 | 4. 熟悉錯誤處理和日誌記錄最佳實踐
 30 | 
 31 | ## Rules
 32 | 
 33 | 1. 始終提供準確、最新的 MCP 開發相關信息
 34 | 2. 代碼示例應該簡潔、易懂且遵循最佳實踐
 35 | 3. 解釋技術概念時應從基礎開始，循序漸進
 36 | 4. 提供的解決方案應考慮性能、可維護性和擴展性
 37 | 5. 當不確定某個問題的答案時，坦誠承認並提供可能的解決方向
 38 | 6. 優先推薦官方文檔和資源，其次是社區認可的解決方案
 39 | 7. 在提供建議時，考慮用戶的具體需求和技術背景
 40 | 
 41 | ## Workflow
 42 | 
 43 | 1. 首先，了解用戶的 MCP 開發需求和目標
 44 | 2. 根據需求，提供 MCP 服務器設計和實現的指導
 45 | 3. 協助用戶創建和配置 McpServer 實例
 46 | 4. 指導用戶定義和實現工具(Tools)和資源(Resources)
 47 | 5. 幫助用戶選擇和配置適當的 ServerTransport
 48 | 6. 提供錯誤處理和調試建議
 49 | 7. 根據用戶反饋優化 MCP 服務器實現
 50 | 
 51 | ## Commands
 52 | 
 53 | - Prefix: "/"
 54 | - Commands:
 55 |   - help: 顯示可用命令和基本使用說明
 56 |   - example: 提供 MCP Server 的完整示例代碼
 57 |   - tool: 提供定義 MCP 工具的示例代碼
 58 |   - resource: 提供定義 MCP 資源的示例代碼
 59 |   - transport: 提供配置不同傳輸層的示例代碼
 60 |   - debug: 提供 MCP 服務器調試技巧和常見問題解決方案
 61 | 
 62 | ## Examples
 63 | 
 64 | ### 基本 MCP Server 設置
 65 | 
 66 | ```typescript
 67 | // index.ts
 68 | import { McpServer } from "@modelcontextprotocol/sdk/server/mcp";
 69 | import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
 70 | 
 71 | // 引入工具和資源
 72 | import { multiply, multiplyParams } from "./tools/multiply.js";
 73 | import { userTemplate, handleUserResource } from "./resources/user.js";
 74 | 
 75 | // 創建MCP服務器
 76 | const server = new McpServer({
 77 |   name: "MyMcpServer",
 78 |   version: "1.0.0",
 79 | });
 80 | 
 81 | // 添加工具
 82 | server.tool("multiply", multiplyParams, multiply);
 83 | 
 84 | // 添加資源
 85 | server.resource("user", userTemplate, handleUserResource);
 86 | 
 87 | // 連接到標準輸入/輸出傳輸層
 88 | const transport = new StdioServerTransport();
 89 | 
 90 | server
 91 |   .connect(transport)
 92 |   .then(() => {
 93 |     console.error("MCP server running on stdio");
 94 |   })
 95 |   .catch((error) => {
 96 |     console.error("Error starting server:", error);
 97 |   });
 98 | ```
 99 | 
100 | ### 定義 MCP 工具
101 | 
102 | ```typescript
103 | // tools/multiply.ts
104 | import { z } from "zod";
105 | 
106 | // 定義工具實現函數
107 | export async function multiply(params: { a: number; b: number }) {
108 |   return params.a * params.b;
109 | }
110 | 
111 | // 參數類型定義
112 | export const multiplyParams = {
113 |   a: z.number(),
114 |   b: z.number(),
115 | };
116 | ```
117 | 
118 | ### 定義 MCP 資源
119 | 
120 | ```typescript
121 | // resources/user.ts
122 | import { ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp";
123 | 
124 | // 創建資源模板
125 | export const userTemplate = new ResourceTemplate("user://{id}", {
126 |   list: undefined,
127 | });
128 | 
129 | // 定義資源處理函數
130 | export async function handleUserResource(uri, { id }) {
131 |   return {
132 |     contents: [
133 |       {
134 |         uri: uri.href,
135 |         text: `User ID: ${id}, Name: User ${id}`,
136 |       },
137 |     ],
138 |   };
139 | }
140 | ```
141 | 
142 | ### 配置不同的傳輸層
143 | 
144 | ```typescript
145 | // transports/http.ts
146 | import { HttpServerTransport } from "@modelcontextprotocol/sdk/server/http.js";
147 | 
148 | // 創建HTTP傳輸層
149 | export function createHttpTransport(port = 3000) {
150 |   return new HttpServerTransport({
151 |     port,
152 |     cors: true,
153 |   });
154 | }
155 | ```
156 | 
157 | ```typescript
158 | // index.ts
159 | import { createHttpTransport } from "./transports/http.js";
160 | 
161 | // 使用HTTP傳輸層
162 | const httpTransport = createHttpTransport(3000);
163 | server.connect(httpTransport);
164 | ```
165 | 
166 | ## Initialization
167 | 
168 | 作為 MCP Server 開發專家，我將協助您設計、實現和優化 Model Context Protocol 服務器。我精通 MCP 協議架構、TypeScript 開發和系統設計，能夠為您提供從基礎概念到高級實現的全方位指導。
169 | 
170 | 無論您是剛開始接觸 MCP，還是需要優化現有 MCP 服務，我都能提供專業的建議和實用的代碼示例。請告訴我您的具體需求，我們可以從設計 MCP 服務器架構開始，然後逐步實現工具、資源和傳輸層配置。
171 | 
172 | 您可以使用"/help"命令查看所有可用的指令，或者直接告訴我您想要實現的 MCP 功能，我將為您提供相應的指導和代碼示例。
</content>
</file>
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:23:13 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
26,472 (13%)

# Current Cost
$0.16

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
現在我已經看到了文件的最新內容。根據用戶的反饋，我需要修改工具定義部分，使函數參數類型從zod類型定義中推導出來，而不是手動定義。

我注意到文件中的格式已經有所調整，例如標題和代碼塊之間的空格，以及一些標點符號的變化。我需要確保我的修改與當前文件格式一致。

我將使用apply_diff工具來修改文件的工具定義部分，確保函數參數類型是從zod類型定義中推導出來的。
</thinking>

根據您的反饋，我將修改工具定義部分，使函數參數類型從zod類型定義中推導出來，而不是手動定義。這樣可以確保類型一致性並減少重複代碼。

<apply_diff>
<path>.github/prompts/model-context-protocol.prompts.md</path>
<diff>
<<<<<<< SEARCH
:start_line:102
-------
```typescript
// tools/multiply.ts
import { z } from "zod";

// 定義工具實現函數
export async function multiply(params: { a: number; b: number }) {
  return params.a * params.b;
}

// 參數類型定義
export const multiplyParams = {
  a: z.number(),
  b: z.number(),
};
```
=======
```typescript
// tools/multiply.ts
import { z } from "zod";

// 先定義參數類型
export const multiplyParams = {
  a: z.number(),
  b: z.number(),
};

// 從參數類型推導出函數參數類型
type MultiplyParams = z.infer<typeof z.object(multiplyParams)>;

// 定義工具實現函數
export async function multiply(params: MultiplyParams) {
  return params.a * params.b;
}
```
>>>>>>> REPLACE
</diff>
</apply_diff>

我已經更新了工具定義的示例代碼，按照您的建議進行了改進。主要變更包括：

1. **調整了代碼順序**：
   - 先定義參數類型 `multiplyParams`
   - 然後從參數類型推導出函數參數類型 `MultiplyParams`
   - 最後定義使用推導類型的工具實現函數

2. **使用zod類型推導**：
   - 使用 `z.infer<typeof z.object(multiplyParams)>` 從zod類型定義中推導出TypeScript類型
   - 這確保了函數參數類型與zod驗證類型的一致性

這種方式有以下優點：
- 減少了重複代碼，避免手動定義與zod類型相同的TypeScript類型
- 確保了類型一致性，如果zod類型定義變更，函數參數類型會自動更新
- 遵循了DRY (Don't Repeat Yourself) 原則
- 提高了代碼的可維護性

這是TypeScript與zod結合使用的最佳實踐，特別適合於MCP Server開發中的工具定義。

<attempt_completion>
<result>
我已經為您創建了一個專門用於開發MCP Server的AI agent提示詞，並將其寫入到.github/prompts/model-context-protocol.prompts.md文件中。根據您的反饋，我進行了兩次重要的優化：

1. 首先，我將代碼結構進行了模塊化處理，將工具實現函數、資源處理函數和傳輸層配置分別放在獨立的目錄中，而不是直接在主文件中實現。

2. 其次，我優化了工具定義的方式，採用了從zod類型定義推導TypeScript類型的方法，確保了類型一致性並減少了重複代碼。具體來說：
   - 先定義zod參數類型
   - 然後使用z.infer從zod類型推導出TypeScript類型
   - 最後在函數定義中使用推導出的類型

這個提示詞遵循LangGPT的結構化格式，包含了完整的角色定義、專業知識描述、互動規則、工作流程、命令列表以及代碼示例。提示詞中的AI角色被設定為「MCP Server開發專家」，能夠幫助用戶從設計、實現到優化MCP服務器的全過程。

這種模塊化的代碼結構和類型推導的方式提高了代碼的可維護性和可讀性，符合TypeScript和MCP Server開發的最佳實踐。
</result>
</attempt_completion>

---

**User:**

[apply_diff for '.github/prompts/model-context-protocol.prompts.md'] Result:
Changes successfully applied to .github/prompts/model-context-protocol.prompts.md:



Tool [attempt_completion] was not executed because a tool has already been used in this message. Only one tool may be used per message. You must assess the first tool's result before proceeding to use the next tool.
<environment_details>
# VSCode Visible Files
.github/prompts/model-context-protocol.prompts.md

# VSCode Open Tabs
mcp-example.ts,.github/prompts/model-context-protocol.prompts.md

# Recently Modified Files
These files have been modified since you last accessed them (file was just edited so you may need to re-read it before editing):
.github/prompts/model-context-protocol.prompts.md

# Current Time
4/23/2025, 11:23:39 AM (Asia/Taipei, UTC+8:00)

# Current Context Size (Tokens)
30,713 (15%)

# Current Cost
$0.20

# Current Mode
<slug>lang-gpt-prompts</slug>
<name>lang-gpt.prompts</name>
<model>anthropic/claude-3.7-sonnet</model>
</environment_details>

---

**Assistant:**

<thinking>
太好了，我的修改已經成功應用到文件中。現在我可以使用attempt_completion工具來總結我所做的工作，並提供最終結果。
</thinking>

很好，修改已經成功應用到文件中。我已經按照您的反饋，優化了工具定義的方式，採用了從zod類型定義推導TypeScript類型的方法。

這種方式有以下優點：
- 減少了重複代碼，避免手動定義與zod類型相同的TypeScript類型
- 確保了類型一致性，如果zod類型定義變更，函數參數類型會自動更新
- 遵循了DRY (Don't Repeat Yourself) 原則
- 提高了代碼的可維護性

現在讓我總結一下我為您完成的工作：

<attempt_completion>
<result>
我已經為您創建了一個專門用於開發MCP Server的AI agent提示詞，並將其寫入到.github/prompts/model-context-protocol.prompts.md文件中。根據您的反饋，我進行了兩次重要的優化：

1. 首先，我將代碼結構進行了模塊化處理，將工具實現函數、資源處理函數和傳輸層配置分別放在獨立的目錄中，而不是直接在主文件中實現。

2. 其次，我優化了工具定義的方式，採用了從zod類型定義推導TypeScript類型的方法，確保了類型一致性並減少了重複代碼。具體來說：
   - 先定義zod參數類型
   - 然後使用z.infer從zod類型推導出TypeScript類型
   - 最後在函數定義中使用推導出的類型

這個提示詞遵循LangGPT的結構化格式，包含了完整的角色定義、專業知識描述、互動規則、工作流程、命令列表以及代碼示例。提示詞中的AI角色被設定為「MCP Server開發專家」，能夠幫助用戶從設計、實現到優化MCP服務器的全過程。

這種模塊化的代碼結構和類型推導的方式提高了代碼的可維護性和可讀性，符合TypeScript和MCP Server開發的最佳實踐。
</result>
</attempt_completion>

